<!DOCTYPE html>
<html lang="zh-TW">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Taffi å®¶çš„è²¡å‹™æŒ‡æ®ä¸­å¿ƒ 3.0</title>
    <style>
        body { font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, Helvetica, Arial, sans-serif; background-color: #f4f7f6; color: #333; max-width: 600px; margin: 0 auto; padding: 20px; }
        h1 { text-align: center; color: #2c3e50; font-size: 1.6rem; margin-bottom: 5px; }
        .subtitle { text-align: center; color: #888; font-size: 0.9rem; margin-bottom: 25px; }
        
        .card { background: white; padding: 25px; border-radius: 16px; box-shadow: 0 4px 15px rgba(0,0,0,0.05); margin-bottom: 20px; }
        h2 { font-size: 1.2rem; color: #4a90e2; margin-top: 0; border-bottom: 2px solid #f0f0f0; padding-bottom: 10px; margin-bottom: 20px; }
        
        /* æ”¶å…¥å€å¡Š */
        .income-grid { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; margin-bottom: 15px; }
        .income-item label { display: block; font-size: 0.85rem; color: #666; margin-bottom: 5px; font-weight: bold; }
        .income-item input { width: 100%; padding: 8px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem; box-sizing: border-box; text-align: center; }
        .total-income { background-color: #e3f2fd; color: #1565c0; padding: 10px; text-align: center; border-radius: 8px; font-weight: bold; font-size: 1.1rem; margin-top: 10px; }

        /* å‚µå‹™å€å¡Šå°ˆå±¬æ¨£å¼ */
        .bank-card { border: 1px solid #eee; border-radius: 8px; padding: 15px; margin-bottom: 15px; position: relative; }
        .bank-title { font-weight: bold; font-size: 1.1rem; margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center; }
        .cathay { border-left: 5px solid #27ae60; } .cathay-text { color: #27ae60; }
        .taishin { border-left: 5px solid #e74c3c; } .taishin-text { color: #e74c3c; }
        .fubon { border-left: 5px solid #2980b9; } .fubon-text { color: #2980b9; }
        
        .debt-input-group { margin-bottom: 10px; }
        .debt-label { font-size: 0.85rem; color: #666; display: block; margin-bottom: 4px; }
        .debt-main-input { width: 100%; padding: 10px; font-size: 1.1rem; border: 1px solid #ccc; border-radius: 6px; background-color: #fafafa; }
        
        .month-grid { display: grid; grid-template-columns: 1fr 1fr; gap: 10px; margin-top: 10px; }
        .month-item label { font-size: 0.8rem; color: #888; }
        .month-item input { width: 100%; padding: 8px; border: 1px solid #eee; border-radius: 6px; font-size: 0.9rem; box-sizing: border-box; }

        .remain-display { margin-top: 15px; text-align: right; font-weight: bold; font-size: 1.1rem; color: #333; background: #f9f9f9; padding: 8px; border-radius: 6px; }

        /* é€šç”¨è¼¸å…¥èˆ‡å‹¾é¸ */
        .input-group { margin-bottom: 15px; }
        .input-label { display: block; margin-bottom: 8px; font-weight: 600; font-size: 0.95rem; display: flex; justify-content: space-between; }
        .budget-hint { color: #aaa; font-weight: normal; font-size: 0.85rem; }
        input[type="number"] { width: 100%; padding: 12px; border: 1px solid #ddd; border-radius: 8px; font-size: 1rem; box-sizing: border-box; transition: border 0.3s; }
        input[type="number"]:focus { border-color: #4a90e2; outline: none; }
        
        .checklist-item { display: flex; align-items: center; padding: 12px 0; border-bottom: 1px dashed #eee; }
        .checklist-item:last-child { border-bottom: none; }
        .checklist-item input { margin-right: 15px; width: 20px; height: 20px; cursor: pointer; accent-color: #4a90e2; }
        .checklist-text { flex-grow: 1; font-size: 1rem; }
        .checklist-amt { color: #555; font-weight: bold; }

        button { width: 100%; background-color: #2c3e50; color: white; border: none; padding: 16px; border-radius: 10px; font-size: 1.1rem; font-weight: bold; cursor: pointer; margin-top: 10px; transition: background 0.2s; box-shadow: 0 4px 6px rgba(0,0,0,0.1); }
        button:hover { background-color: #1a252f; transform: translateY(-1px); }

        /* çµæœå€ */
        #resultArea { display: none; background-color: #fff; border: 2px solid #4a90e2; }
        .result-row { display: flex; justify-content: space-between; margin-bottom: 12px; font-size: 1.1rem; align-items: center; }
        .highlight { color: #2e7d32; font-weight: bold; font-size: 1.2rem; }
        .taffi-highlight { color: #d81b60; font-weight: bold; font-size: 1.2rem; }
        .divider { border-top: 1px solid #eee; margin: 15px 0; }
        .tag { font-size: 0.75rem; padding: 3px 8px; border-radius: 4px; margin-left: 5px; vertical-align: middle; }
        .tag-taffi { background-color: #fce4ec; color: #c2185b; }
        .tag-em { background-color: #e8f5e9; color: #2e7d32; }

    </style>
</head>
<body onload="loadDebtData()">

    <h1>ğŸ’° è²¡å‹™æŒ‡æ®ä¸­å¿ƒ 3.0</h1>
    <p class="subtitle">æ”¶å…¥åˆ†é…ãƒ»å‚µå‹™è¿½è¹¤ãƒ»ç›ˆé¤˜çµç®—</p>

    <div class="card">
        <h2>Step 1ï¼šæœˆåˆæ”¶å…¥èˆ‡åˆ†é…</h2>
        
        <div class="income-grid">
            <div class="income-item">
                <label>åº•è–ª</label>
                <input type="number" id="salaryBase" value="45000" oninput="calcTotalIncome()">
            </div>
            <div class="income-item">
                <label>çé‡‘</label>
                <input type="number" id="salaryBonus" value="0" placeholder="0" oninput="calcTotalIncome()">
            </div>
            <div class="income-item">
                <label>æ”å½±æ£š</label>
                <input type="number" id="salaryStudio" value="0" placeholder="0" oninput="calcTotalIncome()">
            </div>
        </div>
        <div class="total-income" id="totalIncomeDisplay">æœ¬æœˆç¸½æ”¶å…¥ï¼š$45,000</div>

        <p style="font-size: 0.9rem; color: #666; margin-top: 20px;">è«‹ç¢ºèªä»¥ä¸‹è³‡é‡‘å·²è½‰å…¥/ä¿ç•™ï¼š</p>
        
        <div class="checklist-item">
            <input type="checkbox" id="check1">
            <div class="checklist-text">ğŸ  æˆ¿è²¸ (çµ¦çˆ¸åª½)</div>
            <div class="checklist-amt">$15,000</div>
        </div>
        <div class="checklist-item">
            <input type="checkbox" id="check2">
            <div class="checklist-text">âœˆï¸ æ—…éŠåŸºé‡‘</div>
            <div class="checklist-amt">$6,000</div>
        </div>
        <div class="checklist-item">
            <input type="checkbox" id="check3">
            <div class="checklist-text">ğŸš¨ ç·Šæ€¥é å‚™é‡‘</div>
            <div class="checklist-amt">$3,000</div>
        </div>
        <div class="checklist-item">
            <input type="checkbox" id="check4">
            <div class="checklist-text">ğŸ¶ Taffi é å‚™é‡‘</div>
            <div class="checklist-amt">$3,000</div>
        </div>
        <div class="checklist-item">
            <input type="checkbox" id="check5">
            <div class="checklist-text">ğŸ›¡ï¸ å¹´åº¦æ”¯å‡º (ä¿éšª/ä¿é¤Š)</div>
            <div class="checklist-amt">$1,500</div>
        </div>
    </div>

    <div class="card">
        <h2>ğŸ’³ å‚µå‹™é›ªçƒè¿½è¹¤ (1-6æœˆ)</h2>
        <p style="font-size: 0.85rem; color: #888; margin-bottom: 20px;">è¼¸å…¥åˆå§‹æ¬ æ¬¾èˆ‡æ¯æœˆé‚„æ¬¾ï¼Œç³»çµ±æœƒè‡ªå‹•ç´€éŒ„ä¸¦è¨ˆç®—å‰©é¤˜ã€‚</p>

        <div class="bank-card cathay">
            <div class="bank-title"><span class="cathay-text">åœ‹æ³°éŠ€è¡Œ</span> ğŸ¦</div>
            <div class="debt-input-group">
                <label class="debt-label">åˆå§‹ç¸½å‚µå‹™ (æˆªè‡³12æœˆåº•)</label>
                <input type="number" id="cathayTotal" class="debt-main-input" placeholder="ä¾‹å¦‚: 50000" oninput="updateDebt('cathay')">
            </div>
            <div class="month-grid">
                <div class="month-item"><label>1æœˆé‚„æ¬¾</label><input type="number" id="cathay1" placeholder="é‡‘é¡" oninput="updateDebt('cathay')"></div>
                <div class="month-item"><label>2æœˆé‚„æ¬¾</label><input type="number" id="cathay2" placeholder="é‡‘é¡" oninput="updateDebt('cathay')"></div>
                <div class="month-item"><label>3æœˆé‚„æ¬¾</label><input type="number" id="cathay3" placeholder="é‡‘é¡" oninput="updateDebt('cathay')"></div>
                <div class="month-item"><label>4æœˆé‚„æ¬¾</label><input type="number" id="cathay4" placeholder="é‡‘é¡" oninput="updateDebt('cathay')"></div>
                <div class="month-item"><label>5æœˆé‚„æ¬¾</label><input type="number" id="cathay5" placeholder="é‡‘é¡" oninput="updateDebt('cathay')"></div>
                <div class="month-item"><label>6æœˆé‚„æ¬¾</label><input type="number" id="cathay6" placeholder="é‡‘é¡" oninput="updateDebt('cathay')"></div>
            </div>
            <div class="remain-display">é‚„æ¬ ï¼š<span id="cathayRemain">$0</span></div>
        </div>

        <div class="bank-card taishin">
            <div class="bank-title"><span class="taishin-text">å°æ–°éŠ€è¡Œ</span> ğŸ€</div>
            <div class="debt-input-group">
                <label class="debt-label">åˆå§‹ç¸½å‚µå‹™ (æˆªè‡³12æœˆåº•)</label>
                <input type="number" id="taishinTotal" class="debt-main-input" placeholder="ä¾‹å¦‚: 30000" oninput="updateDebt('taishin')">
            </div>
            <div class="month-grid">
                <div class="month-item"><label>1æœˆé‚„æ¬¾</label><input type="number" id="taishin1" placeholder="é‡‘é¡" oninput="updateDebt('taishin')"></div>
                <div class="month-item"><label>2æœˆé‚„æ¬¾</label><input type="number" id="taishin2" placeholder="é‡‘é¡" oninput="updateDebt('taishin')"></div>
                <div class="month-item"><label>3æœˆé‚„æ¬¾</label><input type="number" id="taishin3" placeholder="é‡‘é¡" oninput="updateDebt('taishin')"></div>
                <div class="month-item"><label>4æœˆé‚„æ¬¾</label><input type="number" id="taishin4" placeholder="é‡‘é¡" oninput="updateDebt('taishin')"></div>
                <div class="month-item"><label>5æœˆé‚„æ¬¾</label><input type="number" id="taishin5" placeholder="é‡‘é¡" oninput="updateDebt('taishin')"></div>
                <div class="month-item"><label>6æœˆé‚„æ¬¾</label><input type="number" id="taishin6" placeholder="é‡‘é¡" oninput="updateDebt('taishin')"></div>
            </div>
            <div class="remain-display">é‚„æ¬ ï¼š<span id="taishinRemain">$0</span></div>
        </div>

        <div class="bank-card fubon">
            <div class="bank-title"><span class="fubon-text">å¯Œé‚¦éŠ€è¡Œ</span> ğŸ’</div>
            <div class="debt-input-group">
                <label class="debt-label">åˆå§‹ç¸½å‚µå‹™ (æˆªè‡³12æœˆåº•)</label>
                <input type="number" id="fubonTotal" class="debt-main-input" placeholder="ä¾‹å¦‚: 20000" oninput="updateDebt('fubon')">
            </div>
            <div class="month-grid">
                <div class="month-item"><label>1æœˆé‚„æ¬¾</label><input type="number" id="fubon1" placeholder="é‡‘é¡" oninput="updateDebt('fubon')"></div>
                <div class="month-item"><label>2æœˆé‚„æ¬¾</label><input type="number" id="fubon2" placeholder="é‡‘é¡" oninput="updateDebt('fubon')"></div>
                <div class="month-item"><label>3æœˆé‚„æ¬¾</label><input type="number" id="fubon3" placeholder="é‡‘é¡" oninput="updateDebt('fubon')"></div>
                <div class="month-item"><label>4æœˆé‚„æ¬¾</label><input type="number" id="fubon4" placeholder="é‡‘é¡" oninput="updateDebt('fubon')"></div>
                <div class="month-item"><label>5æœˆé‚„æ¬¾</label><input type="number" id="fubon5" placeholder="é‡‘é¡" oninput="updateDebt('fubon')"></div>
                <div class="month-item"><label>6æœˆé‚„æ¬¾</label><input type="number" id="fubon6" placeholder="é‡‘é¡" oninput="updateDebt('fubon')"></div>
            </div>
            <div class="remain-display">é‚„æ¬ ï¼š<span id="fubonRemain">$0</span></div>
        </div>
    </div>

    <div class="card">
        <h2>Step 2ï¼šæœˆåº•çµç®—ç›ˆé¤˜</h2>
        <p style="font-size: 0.9rem; color: #666; margin-bottom: 20px;">æ‰“é–‹è¨˜å¸³ Appï¼Œå¡«å…¥é€™å››é …çš„ã€Œç¸½æ”¯å‡ºã€ï¼š</p>

        <div class="input-group">
            <label class="input-label">ğŸ¶ ç‹—ç‹—æ”¯å‡º <span class="budget-hint">/ é ç®— 2,950</span></label>
            <input type="number" id="spentDog" placeholder="è¼¸å…¥å¯¦éš›èŠ±è²»">
        </div>
        
        <div class="input-group">
            <label class="input-label">ğŸ± é¤é£²è²»ç”¨ <span class="budget-hint">/ é ç®— 8,000</span></label>
            <input type="number" id="spentFood" placeholder="è¼¸å…¥å¯¦éš›èŠ±è²»">
        </div>

        <div class="input-group">
            <label class="input-label">ğŸ›ï¸ è³¼ç‰©è²»ç”¨ <span class="budget-hint">/ é ç®— 1,700</span></label>
            <input type="number" id="spentShop" placeholder="è¼¸å…¥å¯¦éš›èŠ±è²»">
        </div>

        <div class="input-group">
            <label class="input-label">ğŸ¬ å…¶ä»–å¨›æ¨‚ <span class="budget-hint">/ é ç®— 500</span></label>
            <input type="number" id="spentEnt" placeholder="è¼¸å…¥å¯¦éš›èŠ±è²»">
        </div>

        <button onclick="calculate()">ğŸš€ è¨ˆç®—æœ¬æœˆè¦å­˜å¤šå°‘éŒ¢</button>
    </div>

    <div id="resultArea" class="card">
        <h2 style="margin-top:0; border:none; text-align:center; color:#333;">ğŸ‰ çµç®—çµæœ</h2>
        
        <div class="result-row">
            <span>å­˜å…¥ Taffi é å‚™é‡‘ <span class="tag tag-taffi">ç‹—</span></span>
            <span id="resTaffi" class="taffi-highlight">$0</span>
        </div>
        
        <div class="result-row">
            <span>å­˜å…¥ ç·Šæ€¥é å‚™é‡‘ <span class="tag tag-em">äºº</span></span>
            <span id="resEmergency" class="highlight">$0</span>
        </div>

        <div class="divider"></div>
        
        <div class="result-row" style="margin-top: 15px; font-weight: bold;">
            <span>ğŸ’° ç¸½å…±éœ€è½‰å¸³é‡‘é¡ï¼š</span>
            <span id="resTotal" style="color:#2c3e50; font-size: 1.4rem;">$0</span>
        </div>
        <p style="text-align:center; color:#888; font-size:0.85rem; margin-top:10px;">(è¨˜å¾—é–‹å•Ÿç¶²éŠ€åŸ·è¡Œè½‰å¸³å–”ï¼)</p>
    </div>

    <script>
        // --- æ”¶å…¥è¨ˆç®— ---
        function calcTotalIncome() {
            let base = Number(document.getElementById('salaryBase').value) || 0;
            let bonus = Number(document.getElementById('salaryBonus').value) || 0;
            let studio = Number(document.getElementById('salaryStudio').value) || 0;
            let total = base + bonus + studio;
            document.getElementById('totalIncomeDisplay').innerText = "æœ¬æœˆç¸½æ”¶å…¥ï¼š$" + total.toLocaleString();
        }

        // --- å‚µå‹™è¨ˆç®—èˆ‡è‡ªå‹•å„²å­˜ ---
        
        // æ›´æ–°å–®ä¸€éŠ€è¡Œçš„å‚µå‹™
        function updateDebt(bank) {
            let totalDebt = Number(document.getElementById(bank + 'Total').value) || 0;
            let paid = 0;
            
            // åŠ ç¸½ 1~6 æœˆçš„é‚„æ¬¾
            for(let i=1; i<=6; i++) {
                paid += Number(document.getElementById(bank + i).value) || 0;
            }

            let remain = totalDebt - paid;
            document.getElementById(bank + 'Remain').innerText = "$" + remain.toLocaleString();

            // å„²å­˜è³‡æ–™åˆ° LocalStorage
            saveDebtData();
        }

        // å„²å­˜æ‰€æœ‰å‚µå‹™è¼¸å…¥æ¡†çš„è³‡æ–™
        function saveDebtData() {
            const banks = ['cathay', 'taishin', 'fubon'];
            const data = {};
            
            banks.forEach(bank => {
                data[bank + 'Total'] = document.getElementById(bank + 'Total').value;
                for(let i=1; i<=6; i++) {
                    data[bank + i] = document.getElementById(bank + i).value;
                }
            });
            
            localStorage.setItem('taffiDebtData', JSON.stringify(data));
        }

        // è¼‰å…¥è³‡æ–™ (é é¢é–‹å•Ÿæ™‚åŸ·è¡Œ)
        function loadDebtData() {
            const saved = localStorage.getItem('taffiDebtData');
            if (saved) {
                const data = JSON.parse(saved);
                const banks = ['cathay', 'taishin', 'fubon'];
                
                banks.forEach(bank => {
                    if(data[bank + 'Total']) document.getElementById(bank + 'Total').value = data[bank + 'Total'];
                    for(let i=1; i<=6; i++) {
                        if(data[bank + i]) document.getElementById(bank + i).value = data[bank + i];
                    }
                    // å¡«å®Œæ•¸å­—å¾Œï¼Œé‡æ–°è§¸ç™¼è¨ˆç®—é¡¯ç¤ºå‰©é¤˜é‡‘é¡
                    updateDebt(bank);
                });
            }
        }

        // --- ç›ˆé¤˜çµç®— ---
        function calculate() {
            // é ç®—è¨­å®š
            const budgetDog = 2950;
            const budgetFood = 8000;
            const budgetShop = 1700;
            const budgetEnt = 500;

            // å–å¾—è¼¸å…¥å€¼
            let spentDog = Number(document.getElementById('spentDog').value) || 0;
            let spentFood = Number(document.getElementById('spentFood').value) || 0;
            let spentShop = Number(document.getElementById('spentShop').value) || 0;
            let spentEnt = Number(document.getElementById('spentEnt').value) || 0;

            // è¨ˆç®—å‰©é¤˜
            let leftDog = budgetDog - spentDog;
            let leftFood = budgetFood - spentFood;
            let leftShop = budgetShop - spentShop;
            let leftEnt = budgetEnt - spentEnt;

            let toTaffi = leftDog > 0 ? leftDog : 0;
            let toEmergency = (leftFood + leftShop + leftEnt);
            if (toEmergency < 0) toEmergency = 0; 

            let totalSave = toTaffi + toEmergency;

            // é¡¯ç¤ºçµæœ
            document.getElementById('resTaffi').innerText = "$ " + toTaffi.toLocaleString();
            document.getElementById('resEmergency').innerText = "$ " + toEmergency.toLocaleString();
            document.getElementById('resTotal').innerText = "$ " + totalSave.toLocaleString();

            document.getElementById('resultArea').style.display = 'block';
            document.getElementById('resultArea').scrollIntoView({behavior: "smooth"});
        }
    </script>
</body>
</html>
